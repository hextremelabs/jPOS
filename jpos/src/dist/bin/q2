#!/bin/sh

cd $(dirname $0)/.. || exit 1
rm -f deploy/shutdown.xml

if [ -f jpos.pid ] && ps -p $(cat jpos.pid) > /dev/null 2>&1
then
   echo "Process $(cat jpos.pid) is running"
else
  rm -f jpos.pid
  exec /Library/Java/JavaVirtualMachines/jdk1.8.0_221.jdk/Contents/Home/bin/java -server \
    -Xmx1G \
    -Xloggc:log/gc.log \
    -Djava.net.preferIPv4Stack=true \
    -XX:+ExplicitGCInvokesConcurrentAndUnloadsClasses \
    -XX:+UseConcMarkSweepGC  \
    -XX:+AggressiveOpts \
    -XX:+ParallelRefProcEnabled \
    -XX:ParallelGCThreads=2 \
    -XX:+TieredCompilation \
    -jar bin/jpos-2.1.4-4-bundle-full.jar  --pid="jpos.pid" "$@"
fi

